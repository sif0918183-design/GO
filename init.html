<!DOCTYPE html>  
<html lang="ar" dir="rtl">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>ุชููุฆุฉ ุงููุธุงู - ุชุฑุญุงู ุงูุณูุฏุงู</title>  
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>  
    <link rel="stylesheet" href="css/style.css">  
</head>  
<body>  
    <div class="container">  
        <h1>๐ ุชุฑุญุงู ุงูุณูุฏุงู</h1>  
        <h2>ุชููุฆุฉ ุงููุธุงู ูุงูุฎุฏูุงุช</h2>  
        <p>ูููู ุจุชููุฆุฉ ุงููุธุงู ูุชุญุถูุฑ ุฌููุน ุงูุฎุฏูุงุช ูุถูุงู ุชุฌุฑุจุฉ ุณูุณุฉ ูุขููุฉ</p>  
        <div id="status" style="margin: 30px 0; padding: 20px; background: #f8f9fa; border-radius: 10px;">  
            <h3>ุญุงูุฉ ุงูุชููุฆุฉ:</h3>  
            <p id="statusText">ุฌุงุฑู ุงูุชููุฆุฉ...</p>  
        </div>  
      
        <div id="steps" style="text-align: right;">  
            <h3>ุฎุทูุงุช ุงูุชููุฆุฉ:</h3>  
            <ul id="stepsList" style="list-style: none; padding: 0;">  
                <li id="step1">1. ุชุญููู ููุชุจุงุช ุงููุธุงู</li>  
                <li id="step2">2. ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช</li>  
                <li id="step3">3. ุชููุฆุฉ ุฎุฏูุงุช ุงูุชุฎุฒูู</li>  
                <li id="step4">4. ุจุฏุก ุงูุฎุฏูุงุช</li>  
            </ul>  
        </div>  
      
        <div id="actions" style="margin-top: 40px; display: none;">  
            <button onclick="window.location.href='index.html'"   
                    style="padding: 15px 30px; background: #f39c12; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer;">  
                ุงูุฐูุงุจ ููุตูุญุฉ ุงูุฑุฆูุณูุฉ  
            </button>  
        </div>  
    </div>  

    <script src="js/supabase-config.js"></script>  
    <script src="js/init-system.js"></script>  
  
<script>  
    // ุชุญุฏูุซ ูุงุฌูุฉ ุงููุณุชุฎุฏู  
    function updateStep(stepId, status, message) {  
        const stepElement = document.getElementById(`step${stepId}`);  
        if (stepElement) {  
            stepElement.innerHTML = `${stepId}. ${message}`;  
            stepElement.style.color = status === 'success' ? 'green' :   
                                     status === 'error' ? 'red' :   
                                     status === 'loading' ? 'orange' : 'black';  
        }  
          
        document.getElementById('statusText').textContent = message;  
    }  
      
    // ุจุฏุก ุงูุชููุฆุฉ  
    document.addEventListener('DOMContentLoaded', async () => {  
        updateStep(1, 'loading', 'ุชุญููู ููุชุจุงุช ุงููุธุงู...');  
          
        // 1. ุชุญูู ูู ุชุญููู ุงูููุชุจุฉ ุงูุฃุณุงุณูุฉ
        if (typeof supabase === 'undefined') {  
            updateStep(1, 'error', 'ูุดู ุชุญููู ููุชุจุฉ Supabase ุงูุฃุณุงุณูุฉ');  
            return;  
        }  
        updateStep(1, 'success', 'ุชู ุชุญููู ุงูููุชุจุงุช ุจูุฌุงุญ');  

        // 2. ุงูุชุญูู ูู ุชููุฆุฉ ุงูุนููู (ุงููุดููุฉ ุงูุฃุตููุฉ)
        // ูุณุชุฎุฏู window.supabaseClient ููุง ุชู ุชุนุฑููู ูู supabase-config.js
        if (typeof window.supabaseClient === 'undefined') {
            updateStep(2, 'error', 'ูุดู ุชููุฆุฉ Supabase Client');
            document.getElementById('statusText').innerHTML = 
                '<strong style="color: red;">โ ูุดู ุชููุฆุฉ ุงููุธุงู</strong><br>' +
                'ุงูุฎุทุฃ: Supabase Client ุบูุฑ ูููุฃ. ุชุญูู ูู ููุงุชูุญ API ููุชุบูุฑุงุช ุงูุจูุฆุฉ.';
            return;
        }
          
        // ุจุฏุก ุชููุฆุฉ ุงููุธุงู (ุงูููุชุฑุถ ุฃู initializeTravelSystem() ููุฌูุฏุฉ ูู init-system.js)
        setTimeout(async () => {  
            updateStep(2, 'loading', 'ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช...');  
              
            try {  
                // ุงูุขูุ ููุชุฑุถ ุฃู ุฏุงูุฉ initializeTravelSystem ูููููุง ุงููุตูู ุฅูู window.supabaseClient
                const result = await initializeTravelSystem(); 
                  
                if (result.success) {  
                    updateStep(2, 'success', 'ุชู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช');  
                    updateStep(3, 'success', 'ุชู ุชููุฆุฉ ุฎุฏูุงุช ุงูุชุฎุฒูู');  
                    updateStep(4, 'success', 'ุงูุฎุฏูุงุช ูุดุทุฉ ูุฌุงูุฒุฉ');  
                      
                    document.getElementById('statusText').innerHTML =   
                        '<strong style="color: green;">โ ุชู ุชููุฆุฉ ุงููุธุงู ุจูุฌุงุญ!</strong><br>' +  
                        'ููููู ุงูุขู ุงุณุชุฎุฏุงู ุฌููุน ุฎุฏูุงุช ุชุฑุญุงู ุงูุณูุฏุงู';  
                      
                    document.getElementById('actions').style.display = 'block';  
                } else {  
                    // ูู ุญุงูุฉ ูุดู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช (ูููู ุชู ุชููุฆุชู)
                    updateStep(2, 'error', 'ูุดู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช');  
                    document.getElementById('statusText').innerHTML =   
                        '<strong style="color: red;">โ ูุดู ุชููุฆุฉ ุงููุธุงู</strong><br>' +  
                        'ุงูุฎุทุฃ: ' + (result.error || 'ุบูุฑ ูุนุฑูู') + '<br><br>' +  
                        'ูุฑุฌู ุงูุชุญูู ูู:<br>' +  
                        '1. ุงุชุตุงู ุงูุฅูุชุฑูุช<br>' +  
                        '2. ููุงุชูุญ API (URL/Anon Key)<br>' +  
                        '3. ุชูุนูู CORS<br><br>' +  
                        '<button onclick="location.reload()" style="padding: 10px 20px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer;">ุฅุนุงุฏุฉ ุงููุญุงููุฉ</button>';  
                }  
            } catch (error) {  
                updateStep(2, 'error', 'ุฎุทุฃ ุบูุฑ ูุชููุน ูู ุนูููุฉ ุงูุชููุฆุฉ');  
                console.error('Initialization Error:', error);  
            }  
        }, 1000);  
    });  
</script>

</body>  
</html>
